# Pods

## Pods
Kubernetes doesn't deploy containers directly on the worker node. The Container are encapsulated into a kubernetes object known as pods.
- A pod is a single instance of an application.
- A pod is the smallest object that you can create in K8's.
- To scale your application we launch new pod i.e instance of the same application.
- Pod will have a one-to-one relationship with containers running your application.
- A single pod can have multiple containers except for the fact that they are usually not multiple containers of the same kind.

## Pod Lifecycle
- **Pending** → Accepted by scheduler, waiting for container creation.
- **Running** → All containers running or starting.
- **Succeeded** → All containers exited successfully.
- **Failed** → At least one container exited with failure.
- Pods are ephemeral—when terminated (manually or due to node failure or eviction)

Notes:
- You rarely create Pods directly; instead, use **workload controllers** like `Deployment`, `StatefulSet`, or `DaemonSet`, which manage Pods for scaling, updating, and healing.
- Controllers use a **PodTemplate** to define how to create Pods as part of their desired state.

## Shared Resources in Pods
- Containers in a Pod share:
  - **Network namespace** – same IP and ports, can communicate via localhost. 
  - **Storage volumes**, enabling data sharing across containers.
 
## Pod Scheduling & Controllers
- Pods are scheduled onto Nodes by the control plane based on resource availability and constraints. 
- If a Node fails, the controlling workload object will replace affected Pods on healthy Nodes.

## Types of Pods in Kubernetes

| Pod Type            | Purpose / Description                                                                 | Simple Example YAML / Command Snippet                                    |
| ------------------- | ------------------------------------------------------------------------------------- | ------------------------------------------------------------------------- |
| **Single-Container**    | Runs **one application container**. Most common type of Pod. Simplest to deploy.   | `kubectl run web --image=nginx --restart=Never`                           |
| **Multi-Container**     | Runs **two or more containers** that share the same network and storage. Often uses **sidecar, ambassador, or adapter** patterns. | Pod with `nginx` + `busybox` sidecar for logging.                         |
| **Static Pod**          | Created and managed **directly by kubelet** on a node (bypasses API server). Runs critical system components. | Place manifest in `/etc/kubernetes/manifests/kube-apiserver.yaml`         |
| **Init Container Pod**  | Runs one or more **init containers** before main containers start, for setup/config tasks. | Pod with BusyBox init container waiting for DB before starting app.       |
| **Ephemeral Container** | Special container **added temporarily** to a running Pod for debugging. Does not restart with Pod. | `kubectl debug mypod -it --image=busybox`                                 |
| **Infrastructure Pod**  | Created by controllers (**DaemonSet, StatefulSet, Job, CronJob**) for operational purposes. | **DaemonSet** Pod running node monitoring agent on all nodes.             |

## Commands

```
kubectl -h
kubectl get pod
kubectl get pod -o wide            (Pod IP and node)
kubectl get pod -w                 (watch the status of pods in real-time)
kubectl run <pod-name> --image=<image-name>
kubectl run <pod-name> --image=<image-name> --dry-run=client -o yaml > pod.yaml
kubectl create -f pod.yaml
kubectl describe pod <pod-name>
kubectl edit pod <pod-name?
```

| **Command**          | **Purpose**                                 | **Behavior**                                                                            | **Best For**                                  | **Example**                  |
| -------------------- | ------------------------------------------- | --------------------------------------------------------------------------------------- | --------------------------------------------- | ---------------------------- |
| **`kubectl create`** | Creates a new resource from a file or flags | Fails if the resource already exists                                                    | Creating resources for the first time         | `kubectl create -f pod.yaml` |
| **`kubectl apply`**  | Creates or updates a resource               | Updates existing resources by merging changes from the file into the live configuration | Continuous changes & configuration management | `kubectl apply -f pod.yaml`  |


https://github.com/user-attachments/assets/6050febe-1884-49e1-84c7-b75f08d2c31e


